import{c as L}from"./cartStore-J-oh7sxi.js";import{J as $,K as C,m as _,a as I,_ as m,o as n,c as r,L as b,M as A,b as t,F as f,I as P,t as d,r as h,d as g,O as E}from"./index-Mm90-rHe.js";import{s as T}from"./sweetalert2.all-S9g-JOyd.js";import{p as V}from"./paginationComponent-q2MQv_9Z.js";var k={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"winnie05",BASE_URL:"/Vue2023_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:S,VITE_PATH:w}=k,p=$("allProductsStore",{state:()=>({allProducts:[],categoryList:[]}),actions:{getAllProducts(){const o=`${S}/api/${w}/products/all`;C.get(o).then(e=>{this.allProducts=e.data.products,this.getCategoryList()}).catch(e=>{T.fire({icon:"error",text:e.response.data.message})})},getCategoryList(){const o=new Set(this.allProducts.map(e=>e.category));this.categoryList=[...o]}}}),x={data(){return{currentCategory:""}},watch:{currentCategory(){this.$emit("getProductList",1,this.currentCategory)}},methods:{..._(p,["getAllProducts"])},computed:{...I(p,["allProducts","categoryList"])}},D=t("label",{for:"category",class:"me-3"},"產品分類篩選",-1),R=t("option",{value:""},"全部",-1),B=["value"];function H(o,e,u,l,a,c){return n(),r("div",null,[D,b(t("select",{name:"category",id:"category","onUpdate:modelValue":e[0]||(e[0]=i=>a.currentCategory=i)},[R,(n(!0),r(f,null,P(o.categoryList,i=>(n(),r("option",{value:i,key:i},d(i),9,B))),128))],512),[[A,a.currentCategory]])])}const O=m(x,[["render",H]]);var U={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"winnie05",BASE_URL:"/Vue2023_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:G,VITE_PATH:M}=U,z={data(){return{productsList:[],pagination:{}}},methods:{..._(L,["addToCart"]),..._(p,["getAllProducts"]),getProductList(o=1,e){let u=`${G}/api/${M}/products?page=${o}`;e&&(u+=`&category=${e}`),this.axios.get(u).then(l=>{const{products:a,pagination:c}=l.data;this.productsList=a,this.pagination=c}).catch(l=>{this.$swal.fire({icon:"error",text:l.response.data.message})})},showProductInfo(o){this.$router.push(`/productinfo/${o}`)}},mounted(){this.getProductList(),this.getAllProducts()},components:{paginationComponent:V,filterCategory:O}},F={class:"container"},N=t("h2",{class:"py-5 h2 text-center"},"看產品",-1),J={class:"table align-middle"},K=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),j={style:{width:"200px"}},q={key:0,class:"h5"},Q={key:1},W={class:"h6"},X={class:"h5"},Y={class:"btn-group btn-group-sm"},Z=["onClick"],tt=["onClick"];function et(o,e,u,l,a,c){const i=h("filterCategory"),y=h("paginationComponent");return n(),r("div",F,[N,g(i,{onGetProductList:c.getProductList},null,8,["onGetProductList"]),t("table",J,[K,t("tbody",null,[(n(!0),r(f,null,P(a.productsList,s=>(n(),r("tr",{key:s.id},[t("td",j,[t("div",{style:E([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${s.imageUrl})`}])},null,4)]),t("td",null,d(s.title),1),t("td",null,[s.price?(n(),r("div",Q,[t("del",W,"原價 "+d(s.origin_price)+" 元",1),t("div",X,"現在只要 "+d(s.price)+" 元",1)])):(n(),r("div",q,d(s.origin_price)+" 元",1))]),t("td",null,[t("div",Y,[t("button",{type:"button",class:"btn btn-outline-default",onClick:v=>c.showProductInfo(s.id)}," 查看更多 ",8,Z),t("button",{type:"button",class:"btn btn-default",onClick:v=>o.addToCart(s.id,1)}," 加到購物車 ",8,tt)])])]))),128))])]),g(y,{pagination:a.pagination,onGetList:c.getProductList},null,8,["pagination","onGetList"])])}const at=m(z,[["render",et]]);export{at as default};
