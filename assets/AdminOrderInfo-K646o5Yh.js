import{u as O}from"./allAdminOrderStore-59SYYK3O.js";import{_ as v,U as x,W as I,r as u,o as i,c as d,b as s,t,R as m,g as r,F as b,I as w,d as g,f,w as y,O as S}from"./index-uNT5Tu-G.js";import{t as k}from"./toastComponent-ppIHtYRK.js";import"./sweetalert2.all-wN2xBNXo.js";import"./cartStore-brhShOrF.js";var T={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"winnie05",BASE_URL:"/Vue2023_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const A=x.useLoading(),C=O(),{VITE_API:L,VITE_PATH:P}=T,V={data(){return{tempOrderInfo:{},doAction:null,toastState:!0}},methods:{getOrderInfo(e){const n=C.allOrders.filter(o=>o.id===e),c={...n[0],hasOwnProperty(){return!1}};Object.prototype.hasOwnProperty.call(c,"is_shipping")?this.tempOrderInfo=n[0]:this.tempOrderInfo={...n[0],is_shipping:!1}},updateOrder(e,n){const c=`${L}/api/${P}/admin/order/${e.id}`,h={updatePaid:"更改為「已付款」",updateShipping:"更改為「已出貨」"};this.$swal.fire({title:`確定要更改為${h[n]}嗎？`,icon:"question",text:"這個動作無法復原",showCancelButton:!0,confirmButtonColor:"#787878",cancelButtonColor:"#333333",cancelButtonText:"取消",confirmButtonText:"確認更改"}).then(o=>{if(o.isConfirmed){const _=A.show(),a=Date.now();n==="updatePaid"&&(e.is_paid=!e.is_paid,e.paid_date=Math.floor(a/1e3)),n==="updateShipping"&&(e.is_shipping=!e.is_shipping,e.shipping_date=Math.floor(a/1e3)),this.axios.put(c,{data:e}).then(p=>{this.toastState=!this.toastState,this.doAction=n}).catch(p=>{this.$swal.fire(p.response.data.message)}).finally(_.hide())}})}},computed:{...I(O)},components:{toastComponent:k},mounted(){const e=this.$route.params.id;this.getOrderInfo(e)}},B={class:"overflow-y-scroll scrollbar-y-hide vh-100"},D={class:"py-4 py-md-5 fw-bold"},E={class:"d-flex gap-2"},N={key:0,class:"text-info"},R={key:1,class:"text-danger"},q={key:0,class:"text-info"},M={key:1,class:"text-danger"},U={class:"row g-3"},j={key:0,class:"col-md-7"},z={class:"row flex-column g-3"},F={class:"col"},H={class:"border border-1 rounded"},W={class:"row"},G={class:"col"},J={class:"p-3"},K=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單總金額",-1),Q={class:"mb-2 fs-2 fw-bold"},X={class:"col"},Y={class:"p-3"},Z=s("h3",{class:"mb-2 fs-5 fw-bold"},"商品總數",-1),$={class:"mb-2 fs-2 fw-bold"},ss=s("hr",{class:"m-0"},null,-1),os={class:"p-3"},ts={class:"list-unstyled"},es={class:"row"},ns={class:"col-lg-6"},is={class:"col-lg-6"},ds={class:"row"},ls={class:"col-6"},rs={class:"text-end text-lg-start"},cs={class:"col-6"},_s={class:"text-end"},as={class:"row fw-bold text-end"},ps=s("div",{class:"col-xl-6"},null,-1),hs={class:"col-xl-6"},fs={class:"row"},us=s("div",{class:"col"},[s("p",{class:"text-info"},"小計"),s("p",{class:"text-info"},"coupon 折抵")],-1),ms={class:"col"},bs={class:"text-info"},gs=s("p",{class:"text-danger"},"0",-1),Os=s("hr",null,null,-1),vs={class:"row"},xs=s("div",{class:"col"},[s("p",{class:"fs-5"},"總金額")],-1),Is={class:"col"},ws={class:"fs-5"},ys=s("hr",{class:"m-0"},null,-1),Ss={class:"p-3"},ks=s("h3",{class:"mb-2 fs-5 fw-bold"},"顧客備註",-1),Ts={class:"col"},As={class:"p-3 border border-1 rounded"},Cs=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單紀錄",-1),Ls={class:"d-flex flex-column gap-3 ps-3"},Ps={key:0},Vs={class:"mb-1 text-info fs-info"},Bs=s("p",{class:"fw-bold"}," 出貨日期 ",-1),Ds={key:1},Es={class:"mb-1 text-info fs-info"},Ns=s("p",{class:"fw-bold"}," 付款日期 ",-1),Rs={class:"mb-1 text-info fs-info"},qs=s("p",{class:"fw-bold"}," 訂單產生 ",-1),Ms={class:"col-md-5"},Us={key:0,class:"row flex-column g-3"},js={class:"col"},zs={class:"border border-1 rounded"},Fs=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-person"})]),f("顧客資訊 ")],-1),Hs=s("hr",null,null,-1),Ws={class:"pb-3 px-3"},Gs={class:"fs-5"},Js={class:"text-info list-unstyled"},Ks={class:"col"},Qs={class:"border border-1 rounded"},Xs=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-box-seam"})]),f("宅配地址 ")],-1),Ys=s("hr",null,null,-1),Zs={class:"pb-3 px-3"},$s={class:"fs-5"},so={class:"text-info list-unstyled"};function oo(e,n,c,h,o,_){const a=u("router-link"),p=u("toastComponent");return i(),d(b,null,[s("div",B,[s("h2",D,"訂單編號："+t(o.tempOrderInfo.id),1),s("div",E,[s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",o.tempOrderInfo.is_paid?"border-info":"border-danger"])},[o.tempOrderInfo.is_paid?(i(),d("span",N,"已付款")):(i(),d("span",R,"未付款"))],2),s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",o.tempOrderInfo.is_shipping?"border-info":"border-danger"])},[o.tempOrderInfo.is_shipping?(i(),d("span",q,"已出貨")):(i(),d("span",M,"未出貨"))],2)]),s("div",U,[o.tempOrderInfo.products?(i(),d("div",j,[s("div",z,[s("div",F,[s("div",H,[s("div",W,[s("div",G,[s("div",J,[K,s("p",Q,"NT$ "+t(o.tempOrderInfo.total),1),o.tempOrderInfo.is_paid?r("",!0):(i(),d("button",{key:0,class:"btn btn-default",onClick:n[0]||(n[0]=l=>_.updateOrder(o.tempOrderInfo,"updatePaid"))},"更改為「已付款」"))])]),s("div",X,[s("div",Y,[Z,s("p",$,t(Object.keys(o.tempOrderInfo.products).length),1),o.tempOrderInfo.is_shipping?r("",!0):(i(),d("button",{key:0,class:"btn btn-default",onClick:n[1]||(n[1]=l=>_.updateOrder(o.tempOrderInfo,"updateShipping"))},"出貨"))])])]),ss,s("div",os,[s("ul",ts,[(i(!0),d(b,null,w(o.tempOrderInfo.products,l=>(i(),d("li",{key:l.id,class:"mb-3 pb-3 border-bottom"},[s("div",es,[s("div",ns,[g(a,{to:`/productinfo/${l.product.id}`,target:"_blank",class:"d-flex gap-3 link-hover-decoration fw-bold"},{default:y(()=>[s("div",{style:S([{height:"50px"},{backgroundImage:`url(${l.product.imageUrl})`}]),class:"bg-img-contain bg-img-center bg-img-norepeat ratio-1x1"},null,4),f(" "+t(l.product.title),1)]),_:2},1032,["to"])]),s("div",is,[s("div",ds,[s("div",ls,[s("p",rs,"NT$ "+t(l.product.price.toLocaleString())+" x "+t(l.qty),1)]),s("div",cs,[s("p",_s,"NT$ "+t(l.total.toLocaleString()),1)])])])])]))),128))]),s("div",as,[ps,s("div",hs,[s("div",fs,[us,s("div",ms,[s("p",bs,"NT$ "+t(o.tempOrderInfo.total.toLocaleString()),1),gs])]),Os,s("div",vs,[xs,s("div",Is,[s("p",ws,"NT$ "+t(o.tempOrderInfo.total.toLocaleString()),1)])])])])]),ys,s("div",Ss,[ks,s("p",null,t(o.tempOrderInfo.message),1)])])]),s("div",Ts,[s("div",As,[Cs,s("ul",Ls,[o.tempOrderInfo.shipping_date?(i(),d("li",Ps,[s("p",Vs,t(new Date(o.tempOrderInfo.shipping_date*1e3).toLocaleString()),1),Bs])):r("",!0),o.tempOrderInfo.paid_date?(i(),d("li",Ds,[s("p",Es,t(new Date(o.tempOrderInfo.paid_date*1e3).toLocaleString()),1),Ns])):r("",!0),s("li",null,[s("p",Rs,t(new Date(o.tempOrderInfo.create_at*1e3).toLocaleString()),1),qs])])])])])])):r("",!0),s("div",Ms,[o.tempOrderInfo.user?(i(),d("div",Us,[s("div",js,[s("div",zs,[Fs,Hs,s("div",Ws,[s("p",Gs,t(o.tempOrderInfo.user.name),1),s("ul",Js,[s("li",null,t(o.tempOrderInfo.user.email),1),s("li",null,t(o.tempOrderInfo.user.tel),1),s("li",null,t(o.tempOrderInfo.user.address),1)])])])]),s("div",Ks,[s("div",Qs,[Xs,Ys,s("div",Zs,[s("p",$s,t(o.tempOrderInfo.user.name),1),s("ul",so,[s("li",null,t(o.tempOrderInfo.user.address),1),s("li",null,t(o.tempOrderInfo.user.tel),1)])])])])])):r("",!0)])])]),g(p,{adminOrderState:o.toastState,adminOrderAction:o.doAction},null,8,["adminOrderState","adminOrderAction"])],64)}const ro=v(V,[["render",oo]]);export{ro as default};
