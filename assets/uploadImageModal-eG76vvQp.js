import{J as c,K as m,_ as p,o as d,c as n,b as t,O as h,L as u,Q as g}from"./index-uNT5Tu-G.js";import{s as _}from"./sweetalert2.all-wN2xBNXo.js";import{M as f}from"./modal-Q7As6neB.js";var b={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"winnie05",BASE_URL:"/Vue2023_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:I,VITE_PATH:v}=b,K=c("adminProducts",{state:()=>({allProducts:[],categoryList:[]}),actions:{getAllProducts(){const s=`${I}/api/${v}/admin/products/all`;return m.get(s).then(e=>(this.allProducts=e.data.products,this.getCategoryList(),e)).catch(e=>{_.fire({icon:"error",text:e.response.data.message})})},getCategoryList(){const s=Object.values(this.allProducts),e=new Set(s.map(o=>o.category));this.categoryList=[...e]}}});var y={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"winnie05",BASE_URL:"/Vue2023_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:A,VITE_PATH:M}=y,U={props:["isCover"],data(){return{modal:null,dropArea:null,accept:["jpg","jpeg","png"],imgUrl:""}},methods:{openModal(){this.modal.show()},closeModal(){this.modal.hide()},handleFile(s){const e=s.target.files[0];if(console.log(e),e.size/(1024*1024)>3)return this.$swal.fire({icon:"error",text:"請上傳 3MB 以內的圖檔"}),this.resetDropArea(),!1;const a=e.type.split("/")[1];if(!this.accept.find(i=>i===a))return this.$swal.fire({icon:"error",text:"僅限使用 jpg、jpeg 與 png 格式圖檔"}),this.resetDropArea(),!1;this.uploadImage(e)},uploadImage(s){const e=this.$loading.show(),o=new FormData;o.append("file-to-upload",s),this.axios.post(`${A}/api/${M}/admin/upload`,o).then(l=>{this.imgUrl=l.data.imageUrl}).catch(l=>{console.log(l),this.$swal.fire({icon:"error",text:l.response})}).finally(()=>{e.hide()})},resetDropArea(){this.dropArea.value=""},submitImgUrl(){this.isCover?this.$emit("submitImgUrl","imageUrl",this.imgUrl):this.$emit("submitImgUrl","imagesUrl",this.imgUrl),this.imgUrl="",this.closeModal()}},mounted(){this.modal=new f(this.$refs.uploadImageModal,{keyboard:!1,backdrop:"static"}),this.dropArea=this.$refs.dropArea}},x={ref:"uploadImageModal",class:"modal fade","aria-hidden":"true","aria-labelledby":"uploadImageModal",tabindex:"-1"},T={class:"modal-dialog modal-lg modal-dialog-centered"},w={class:"modal-content"},P={class:"modal-header"},E={key:0,class:"modal-title text-bold fw-bold"},V={key:1,class:"modal-title text-bold fw-bold"},S=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),k={class:"modal-body container"},D={class:"row g-3"},B={class:"col-12 col-md-4"},$={class:"drop-area ratio-1x1"},C={key:1},L={class:"col-12 col-md-8"},j=t("p",{class:"mb-1"},"僅限使用 jpg、jpeg 與 png 格式，檔案大小限制為 3MB 以下",-1),z=["accept"],O={class:"modal-footer"};function R(s,e,o,l,a,r){return d(),n("div",x,[t("div",T,[t("div",w,[t("div",P,[o.isCover?(d(),n("h5",E,"上傳封面")):(d(),n("h5",V,"上傳圖片")),S]),t("div",k,[t("div",D,[t("div",B,[t("div",$,[a.imgUrl?(d(),n("div",{key:0,style:h(`background-image:url(${a.imgUrl})`),class:"w-100 h-100 bg-img-contain bg-img-center bg-img-norepeat"},null,4)):(d(),n("p",C,"圖片預覽"))])]),t("div",L,[j,u(t("input",{class:"form-control mb-1",type:"text",placeholder:"請填入圖片網址","onUpdate:modelValue":e[0]||(e[0]=i=>a.imgUrl=i)},null,512),[[g,a.imgUrl]]),t("input",{class:"form-control",type:"file",ref:"dropArea",accept:a.accept,onChange:e[1]||(e[1]=(...i)=>r.handleFile&&r.handleFile(...i))},null,40,z)])])]),t("div",O,[t("button",{type:"button",class:"btn btn-dark",onClick:e[2]||(e[2]=(...i)=>r.submitImgUrl&&r.submitImgUrl(...i))},"送出")])])])],512)}const N=p(U,[["render",R]]);export{N as a,K as u};
